<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create event - MeetUp App</title>
    <link rel="stylesheet" href="css/app.css">
    <link rel="stylesheet" href="css/icons/foundation-icons.css" />
    <link rel="stylesheet" href="node_modules/foundation-datepicker/css/foundation-datepicker.css">
</head>

<body>
    <div class="row">
        <div class="small-12 medium-10 medium-centered columns">
            <div class="menu-centered">
                <ul class="menu">
                    <li><a class="button hollow" href="/">Home</a></li>
                    <li><a class="button success" href="create_event.html">Create Event</a></li>
                    <li><a class="button hollow" href="list_events.html">Events</a></li>
                    <li><a class="button hollow" href="login.html">login</a></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="divider"></div>
    <div class="row">
        <div class="large-8 large-centered small-12">
            <div class="callout alert" id="locationError" style="display:none;">
                <h2>Geolocation not supported</h2>
                <p>Stop using Internet Explorer. Switch to a modern browser!</p>
            </div>
            <div class="callout secondary">
                <h2>Plan your event</h2>
                <p>Let's plan your next event together, shall we?</p>
            </div>
            <form data-abide novalidate>
                <fieldset class="fieldset">
                    <legend>Event details</legend>
                    <div class="row">
                        <div class="medium-6 columns">
                            <label>Event name
                                <input type="text" placeholder="e.g 'After school party'" min="5" required autofocus autocomplete aria-describedby="eventHelpText">
                                <span class="form-error">
                                  Don't leave this empty
                                </span>
                            </label>
                            <p class="help-text" id="eventHelpText">Minimum of 5 characters.</p>
                        </div>
                        <div class="medium-6 columns">
                            <label>Event type
                                <input list='eventType' type='text' autocomplete placeholder="Choose event type" required>
                                <datalist id="eventType" name="eventType">
                                    <option></option>
                                    <option value="Birthday">Birthday</option>
                                    <option value="Conference">Conference</option>
                                    <option value="Wedding">Wedding</option>
                                    <option>Other</option>
                                </datalist>
                                <span class="form-error">
                                  Don't leave this empty
                                </span>
                            </label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="medium-6 columns">
                            <label>Event host
                                <input list='eventHost' type='text' placeholder="Individual or Organization" required autocomplete />
                                <datalist id="eventHost" name="eventHost">
                                    <option></option>
                                    <option value="individual">Individual</option>
                                    <option value="organization">organization</option>
                                </datalist>
                                <span class="form-error">
                                  Don't leave this empty
                                </span>
                            </label>
                        </div>
                        <div class="medium-6 columns">
                            <label>Event location
                                <div class="input-group">
                                    <input class="input-group-field" type="text" id="location" autocomplete required aria-describedby="status">
                                    <div class="input-group-button">
                                        <a class="button" onclick="getLocation()">Get location</a>
                                    </div>
                                    <span class="form-error">
                                        Don't leave this empty
                                    </span>
                                </div>
                            </label>
                            <p id="status" class="help-text">
                                Click the button to get your position.
                            </p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="small-6 columns">
                            <label>Start date
                                <input type="datetime" id="dateOne" required></input>
                            </label>
                        </div>
                        <div class="small-6 columns">
                            <label>End date
                                <input type="datetime" id="dateTwo">
                            </label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="medium-6 columns">
                            <label>Guest list
                                <textarea placeholder="Enter guest names, one each line" rows="3"></textarea>
                            </label>
                        </div>
                        <div class="medium-6 columns">
                            <label>Optional message
                                <textarea placeholder="Any message to add about the above event?" rows="3"></textarea>
                            </label>
                        </div>
                    </div>
                    <input type="submit" class="button"></input>
                </fieldset>
            </form>
        </div>
    </div>
    <script src="bower_components/jquery/dist/jquery.js"></script>
    <script src="bower_components/what-input/what-input.js"></script>
    <script src="bower_components/foundation-sites/dist/foundation.min.js"></script>
    <script src="js/app.js"></script>
    <script src="node_modules/foundation-datepicker/js/foundation-datepicker.min.js"></script>
    <script>
    //
    // Check if we can get geo location and show it on a map in case we can.
    //
    function getLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition, showError);
        } else {
            var status = document.getElementById("locationError");
            status.style.display = 'block';
        }
    }

    function showPosition(position) {
        console.log('showPosition I am in action');
        var geoPoint = position.coords.latitude + "," + position.coords.longitude;
        console.log(position.coords.latitude + ' ' + position.coords.longitude);
        document.getElementById('location').value = position.coords.latitude + ', ' + position.coords.longitude;
    }

    // show our errors for debuging
    function showError(error) {
        var x = document.getElementById("status");
        x.style.color = 'red';
        switch (error.code) {
            case error.PERMISSION_DENIED:
                x.innerHTML = "Denied the request for Geolocation. Maybe, ask the user in a more polite way?"
                break;
            case error.POSITION_UNAVAILABLE:
                x.innerHTML = "Location information is unavailable.";
                break;
            case error.TIMEOUT:
                x.innerHTML = "The request to get location timed out.";
                break;
            case error.UNKNOWN_ERROR:
                x.innerHTML = "An unknown error occurred :(";
                break;
        }
    }
    $(function() {
        // implementation of disabled form fields
        var nowTemp = new Date();
        var now = new Date(nowTemp.getFullYear(), nowTemp.getMonth(), nowTemp.getDate(), 0, 0, 0, 0);
        var start_date = $('#dateOne').fdatepicker({
            onRender: function(date) {
                return date.valueOf() < now.valueOf() ? 'disabled' : '';
            }
        }).on('changeDate', function(ev) {
            if (ev.date.valueOf() > end_date.date.valueOf()) {
                var newDate = new Date(ev.date)
                newDate.setDate(newDate.getDate() + 1);
                end_date.update(newDate);
            }
            start_date.hide();
            $('#dateTwo')[0].focus();
        }).data('datepicker');
        var end_date = $('#dateTwo').fdatepicker({
            onRender: function(date) {
                return date.valueOf() <= start_date.date.valueOf() ? 'disabled' : '';
            }
        }).on('changeDate', function(ev) {
            end_date.hide();
        }).data('datepicker');
    });
    </script>
</body>

</html>
